<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{layout :: page_head}"></head>
<body>
<nav th:replace="~{layout :: page_nav}"></nav>
<div class="container py-3">

    <form action="#" th:action="@{/books/save}" th:object="${form}"
          method="post">
        <fieldset>
            <input type="submit" id="submitButton" th:value="Save">
            <input type="reset" id="resetButton" name="reset" th:value="Reset"/>
            <input type="text" th:field="*{title}" th:text="${form.title}" />
            <p th:if="${#fields.hasErrors('title')}" th:errors="*{title}"></p>
            <br/>
            <table>
                <thead>
                <tr>
                    <th> Id</th>
                    <th> Title</th>
                    <th> Author</th>
                    <th> Proposals</th>
                    <th> Answer</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="book, itemStat : ${form.books}">
                    <td>
                        <input readonly th:name="|books[${itemStat.index}].id|" th:value="${book.getId()}"/>
                    </td>
                    <td>
                        <input th:name="|books[${itemStat.index}].title|" th:value="${book.getTitle()}"/>
                    </td>
                    <td>
                        <input th:name="|books[${itemStat.index}].author|" th:value="${book.getAuthor()}"/>
                    </td>
                    <td>
                        <input th:name="|books[${itemStat.index}].proposals|" th:value="${book.getProposals()}"/>
                    </td>
                    <td th:each="proposal, stat : ${book.getProposals()}">
                        <label for="answer">[[${proposal}]]</label>
                        <input type="radio" id="answer" th:name="|books[${itemStat.index}].id|"
                               th:field="*{books[__${itemStat.index}__].answer}" th:value="${stat.index}"
                               th:text="${proposal}"/>
                        <p th:if="*{#fields.hasErrors('books[__${itemStat.index}__].answer')}" th:errors="*{books[__${itemStat.index}__].answer}"></p>

                    </td>
                </tr>
                </tbody>
            </table>
        </fieldset>
    </form>

</div>
<footer th:replace="~{layout :: page_footer}"></footer>
</body>
</html>
